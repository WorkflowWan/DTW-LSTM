# Denoising Time Window Optimized  LSTM(DTW-LSTM) Algorithm

这个算法旨在通过聚类模型和去噪模型等手段，实现更好的时间序列预测效果，包括但不限于预测精度和训练成本等等。该方法已与部分该领域主流算法、SOTA算法等对比，证明了算法的有效性，同时还给出了有关本算法的参数建议和消融实验。

本代码由以下几个部分组成：

1. startup.py: 这个部分是读者和从业者应当关心的部分，用作超参数的调整(如聚类阈值、时间窗长度、数据尺度等细节)。需要注意的是，你需要提供两份数据来运行这个程序，一份是原始的用于预测的时间序列，一份是这个序列有关的拟合序列(其中，回归方法可能需要你根据运行的数据形状来自行确定)。考虑到在进行本实验的过程中，作者仅通过MATLAB的工具箱寻求最似函数并根据函数表达式生成对应的拟合序列，这段代码强烈地依赖特定问题处理过程中的手工设计，因此不公开这段代码。
   - `Length`：超参数，你的时间窗长度
   - `TrainLimit`：超参数，你的数据总长度
   - `threshold_pa`：超参数，你的聚类阈值
   - `Fourier`：拟合数据。你可以更换为自己的拟合数据
   - `PekingTemp`：原始数据。你可以更换为自己的拟合数据
2. dataStack.py：特殊的用于融合拟合序列和原始序列的方法，从而降低原始序列的异常噪声。你可以设计自己的融合模型。最后，这个脚本将返回一个融合后的数据结果。
3. main.py: 用于启动的程序
   - `bestSeq`：返回的处理以后的训练集数据，你可以基于此在你本地运行LSTM网络或者其他模型及算法。
   - `bestSeq_test`：返回的测试集数据，未作处理
   - `nums_Cluster`: 聚类点数量统计
   - `nums_LegalTimes`：合法时间窗状态统计(即多少个时间窗内部的特征是正常的)





# 注意事项

- 本实验私有数据集(已经经过预处理以后的)公开在data的文件夹内，其中，data1是拟合序列，data2是原时间序列。已经做好初始化的IO处理。
- 本代码没有大量的python脚本。实际上，原先的实验经过几次变动，首先是完全依赖MATLAB工具箱进行实验，第二阶段，推倒了过去的大部分算法设计，并重构了一个python项目进行实验，但实验仍然依赖MATLAB工具箱进行数据预处理和LSTM的训练及预测。本项目的构建属于第三阶段，旨在公开实验代码，同时重构代码，确保代码的可阅读性。但考虑到本实验并不属于深度学习架构上的创新范畴，故只提供对于数据处理的相关代码。你仍然需要通过本地搭建相关的神经网络(本实验采用的是基础的LSTM)进行训练和预测你的模型和结果。
- 最终输出的数据 `bestSeq` 可能会与预期长度存在几个单位的误差，但应当不会多余一个时间窗的误差。你可以适当调整误差至合理范围，或令数据后处理至合理数据。